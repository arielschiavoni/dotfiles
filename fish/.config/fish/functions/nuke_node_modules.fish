function nuke_node_modules --argument directory -d "Finds and deletes all node_modules folders under the given directory"
  if test -d "$HOME/$directory"
    # --prune stops traversing once the first node_modules folder was found
    # xargs -P is useful to parallelise the deletion of the folders, 0 means maxprocs
    # the -t flag prints the command before running it
    fd --no-ignore -t d node_modules $HOME/$directory --prune | xargs -t -P 0 -I {} rm -rf {}
  else
    echo "The provided directory: $directory is not a subdirectory of $HOME"
    return 1
  end
end
